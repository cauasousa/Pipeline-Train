<div class="section" id="training-page">
    <h2>üß† Treinamento</h2>

    <hr style="margin: 15px 0;">

    <div class="card" style="margin-bottom: 20px;">
        <div class="form-group">
            <label><strong>1. Sele√ß√£o de Dataset (Positivo)</strong></label>
            <div style="display:flex; gap: 10px; align-items: center;">
                <select id="dataset-select" class="input" style="flex-grow: 1;"></select>
                <button class="btn" id="upload-dataset-btn" style="flex-shrink: 0;">üìÅ Upload Pasta</button>
            </div>
        </div>
    </div>

    <div class="card config-card" style="margin-bottom: 20px;">
        <label><strong>2. Divis√£o e Configura√ß√£o do Conjunto de Dados</strong></label>

        <h4 style="margin-top:15px; margin-bottom:5px;">2a. Divis√£o da Classe Positiva (Upload)</h4>
        <p style="font-size:0.9rem; color:var(--text-muted); margin-bottom: 10px;">
            Ajuste as propor√ß√µes de treino, valida√ß√£o e teste (Total = 100%).
        </p>
        <div style="display:flex; gap:8px; flex-wrap:wrap;">
            <div class="form-group">
                <label>Train (%)</label>
                <input type="number" id="train-percent" class="input" value="70" min="0" max="100">
            </div>
            <div class="form-group">
                <label>Val (%)</label>
                <input type="number" id="val-percent" class="input" value="20" min="0" max="100">
            </div>
            <div class="form-group">
                <label>Test (%)</label>
                <input type="number" id="test-percent" class="input" value="10" min="0" max="100">
            </div>
        </div>

        <hr style="margin:20px 0;">
        
        <h4 style="margin-bottom:10px;">2b. Dados de Negativos (Sele√ß√£o por Linha)</h4>
        <p style="font-size:0.9rem; color:var(--text-muted); margin-bottom: 15px;">Selecione e defina a
            quantidade de imagens para a classe negativa (<code>negativo</code>), por tipo ou linha espec√≠fica.</p>

        <div id="negative-data-control">


            <div class="table-container">
                <table class="table" id="negative-selection-table">
                    <thead>
                        <tr>
                            <th style="width: 35%;">Tipo de Implante</th>
                            <th style="width: 25%;">Detalhes</th>
                            <th style="width: 20%;">Linhas Ativas</th>
                            <th style="width: 20%;">Total de Imagens</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr data-type="Cone" data-name="Cone Morse">
                            <td>
                                <div style="display:flex; align-items:center; gap: 8px;">
                                    <input type="checkbox" id="check-cone" value="Cone" checked>
                                    <label for="check-cone" style="margin: 0;">Cone Morse</label>
                                </div>
                            </td>
                            <td>
                                <button class="btn btn-sm" onclick="global.UI.toggleLineSelection(this, 'Cone')">‚öôÔ∏è
                                    Detalhes</button>
                            </td>
                            <td class="selected-lines-count">X Linhas</td>
                            <td class="total-selected-count">X Imagens</td>
                        </tr>
                        <tr class="line-detail-row hidden" data-parent="Cone">
                            <td colspan="4" style="padding: 0;">
                                <div class="line-detail-panel" style="background:#E9ECF1; padding: 15px;">

                                    <div class="line-detail-actions"
                                        style="display:flex;justify-content:space-between;align-items:center;margin-bottom: 10px;">
                                        <strong style="font-size: 14px;">Configura√ß√£o de Sele√ß√£o:</strong>

                                    </div>

                                    <div class="mode-options-group"
                                        style="display: flex; gap: 20px; margin-bottom: 15px; padding: 8px; border: 1px solid var(--border); border-radius: 6px; background: #fff;">
                                        <label style="display: flex; align-items: center; gap: 5px;">
                                            <input type="radio" name="mode-Cone" value="random" checked
                                                onchange="global.UI.setNegativeSelectionMode('Cone', 'random')">
                                            Implantes Aleat√≥rios
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 5px;">
                                            <input type="radio" name="mode-Cone" value="select"
                                                onchange="global.UI.setNegativeSelectionMode('Cone', 'select')">
                                            Selecionar Linhas
                                        </label>
                                    </div>

                                    <div class="line-random-panel" data-type="Cone"
                                        style="padding: 10px; border: 1px dashed var(--border); border-radius: 6px;">
                                        <label style="font-weight: 600;">Quantidade Por Linha (Autom√°tica):</label>
                                        <input type="number" data-type-count="Cone"
                                            class="input input-small type-count-input" value="100" min="0" max="9999"
                                            style="max-width: 120px;" />
                                        <p style="font-size:0.8rem; color:var(--text-muted); margin-top: 5px;">Aplica o
                                            valor acima a TODAS as <span class="available-lines-count">X</span> linhas
                                            dispon√≠veis.</p>
                                    </div>

                                    <div class="line-detail-grid line-select-panel" data-type="Cone"
                                        style="display: none; border: 1px dashed var(--border); padding: 15px; border-radius: 6px; margin-top: 10px; background: #fff;">
                                    </div>

                                </div>
                            </td>
                        </tr>

                        <tr data-type="Hex Externo" data-name="Hex. Externo">
                            <td>
                                <div style="display:flex; align-items:center; gap: 8px;">
                                    <input type="checkbox" id="check-hexext" value="Hex Externo">
                                    <label for="check-hexext" style="margin: 0;">Hex. Externo</label>
                                </div>
                            </td>
                            <td>
                                <button class="btn btn-sm"
                                    onclick="global.UI.toggleLineSelection(this, 'Hex Externo')">‚öôÔ∏è Detalhes</button>
                            </td>
                            <td class="selected-lines-count">X Linhas</td>
                            <td class="total-selected-count">X Imagens</td>
                        </tr>
                        <tr class="line-detail-row hidden" data-parent="Hex Externo">
                            <td colspan="4" style="padding: 0;">
                                <div class="line-detail-panel" style="background:#E9ECF1; padding: 15px;">

                                    <div class="line-detail-actions"
                                        style="display:flex;justify-content:space-between;align-items:center;margin-bottom: 10px;">
                                        <strong style="font-size: 14px;">Configura√ß√£o de Sele√ß√£o:</strong>

                                    </div>

                                    <div class="mode-options-group"
                                        style="display: flex; gap: 20px; margin-bottom: 15px; padding: 8px; border: 1px solid var(--border); border-radius: 6px; background: #fff;">
                                        <label style="display: flex; align-items: center; gap: 5px;">
                                            <input type="radio" name="mode-Hex Externo" value="random" checked
                                                onchange="global.UI.setNegativeSelectionMode('Hex Externo', 'random')">
                                            Implantes Aleat√≥rios
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 5px;">
                                            <input type="radio" name="mode-Hex Externo" value="select"
                                                onchange="global.UI.setNegativeSelectionMode('Hex Externo', 'select')">
                                            Selecionar Linhas
                                        </label>
                                    </div>

                                    <div class="line-random-panel" data-type="Hex Externo"
                                        style="padding: 10px; border: 1px dashed var(--border); border-radius: 6px;">
                                        <label style="font-weight: 600;">Quantidade Por Linha (Autom√°tica):</label>
                                        <input type="number" data-type-count="Hex Externo"
                                            class="input input-small type-count-input" value="100" min="0" max="9999"
                                            style="max-width: 120px;" />
                                        <p style="font-size:0.8rem; color:var(--text-muted); margin-top: 5px;">Aplica o
                                            valor acima a TODAS as <span class="available-lines-count">X</span> linhas
                                            dispon√≠veis.</p>
                                    </div>

                                    <div class="line-detail-grid line-select-panel" data-type="Hex Externo"
                                        style="display: none; border: 1px dashed var(--border); padding: 15px; border-radius: 6px; margin-top: 10px; background: #fff;">
                                    </div>
                                </div>
                            </td>
                        </tr>

                        <tr data-type="Hex Interno" data-name="Hex. Interno">
                            <td>
                                <div style="display:flex; align-items:center; gap: 8px;">
                                    <input type="checkbox" id="check-hexint" value="Hex Interno">
                                    <label for="check-hexint" style="margin: 0;">Hex. Interno</label>
                                </div>
                            </td>
                            <td>
                                <button class="btn btn-sm"
                                    onclick="global.UI.toggleLineSelection(this, 'Hex Interno')">‚öôÔ∏è Detalhes</button>
                            </td>
                            <td class="selected-lines-count">X Linhas</td>
                            <td class="total-selected-count">X Imagens</td>
                        </tr>
                        <tr class="line-detail-row hidden" data-parent="Hex Interno">
                            <td colspan="4" style="padding: 0;">
                                <div class="line-detail-panel" style="background:#E9ECF1; padding: 15px;">

                                    <div class="line-detail-actions"
                                        style="display:flex;justify-content:space-between;align-items:center;margin-bottom: 10px;">
                                        <strong style="font-size: 14px;">Configura√ß√£o de Sele√ß√£o:</strong>

                                    </div>

                                    <div class="mode-options-group"
                                        style="display: flex; gap: 20px; margin-bottom: 15px; padding: 8px; border: 1px solid var(--border); border-radius: 6px; background: #fff;">
                                        <label style="display: flex; align-items: center; gap: 5px;">
                                            <input type="radio" name="mode-Hex Interno" value="random" checked
                                                onchange="global.UI.setNegativeSelectionMode('Hex Interno', 'random')">
                                            Implantes Aleat√≥rios
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 5px;">
                                            <input type="radio" name="mode-Hex Interno" value="select"
                                                onchange="global.UI.setNegativeSelectionMode('Hex Interno', 'select')">
                                            Selecionar Linhas
                                        </label>
                                    </div>

                                    <div class="line-random-panel" data-type="Hex Interno"
                                        style="padding: 10px; border: 1px dashed var(--border); border-radius: 6px;">
                                        <label style="font-weight: 600;">Quantidade Por Linha (Autom√°tica):</label>
                                        <input type="number" data-type-count="Hex Interno"
                                            class="input input-small type-count-input" value="100" min="0" max="9999"
                                            style="max-width: 120px;" />
                                        <p style="font-size:0.8rem; color:var(--text-muted); margin-top: 5px;">Aplica o
                                            valor acima a TODAS as <span class="available-lines-count">X</span> linhas
                                            dispon√≠veis (1 linha impl√≠cita).</p>
                                    </div>

                                    <div class="line-detail-grid line-select-panel" data-type="Hex Interno"
                                        style="display: none; border: 1px dashed var(--border); padding: 15px; border-radius: 6px; margin-top: 10px; background: #fff;">
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div style="margin-top:20px;">
                <label>Separa√ß√£o do Conjunto Negativo (P/ cada Linha)</label>
                <div style="display:flex; flex-wrap:wrap; gap:8px;">
                    <div><label>Train (%)</label><input type="number" id="rand-train-percent" class="input" value="70"
                            min="0" max="100"></div>
                    <div><label>Val (%)</label><input type="number" id="rand-val-percent" class="input" value="20"
                            min="0" max="100"></div>
                    <div><label>Test (%)</label><input type="number" id="rand-test-percent" class="input" value="10"
                            min="0" max="100"></div>
                </div>
            </div>
        </div>

        <div class="card" style="margin-top:15px;">
            <h3 style="margin: 0 0 10px 0; color: var(--text-primary);">
                üìä Resumo do Conjunto de Dados (Estimativa)
            </h3>

            <ul id="dataset-summary" class="dataset-summary-list">

                <li>
                    <div style="display: flex; align-items: center;">
                        <span class="data-icon" style="color: #28a745;">&#10003;</span> Total de imagens Positivas
                        (Upload)
                    </div>
                    <span id="total-positive-count" class="total-positive">1000</span>
                </li>

                <li>
                    <div style="display: flex; align-items: center;">
                        <span class="data-icon" style="color: #dc3545;">&#10005;</span> Total de imagens Negativas
                        (Selecionadas)
                    </div>
                    <span id="total-negative-count" class="total-negative">0</span>
                </li>

                <li class="total-highlight">
                    Total Geral Estimado
                    <span id="total-all" class="total-all">1000</span>
                </li>
                <li class="">
                    <div style="display: flex; align-items: center;">
                        <span class="data-icon" style="color: var(--text-secondary);">&#9679;</span> Divis√£o Positivos
                        Train/Val/Test
                    </div>
                    <span id="positive-split">0 / 0 / 0</span>
                </li>
                <li class="">
                    <div style="display: flex; align-items: center;">
                        <span class="data-icon" style="color: var(--text-secondary);">&#9679;</span> Divis√£o Negativos
                        Train/Val/Test
                    </div>
                    <span id="negative-split">0 / 0 / 0</span>
                </li>
                <li>
                    <div style="display: flex; align-items: center;">
                        <span class="data-icon" style="color: var(--text-secondary);">&#9679;</span> Divis√£o total
                        Train/Val/Test
                    </div>
                    <span id="total-split">700 / 200 / 100</span>
                </li>
            </ul>
        </div>
    </div>

    <div class="card config-card" style="margin-bottom: 20px;">
        <label><strong>3. Tipos de Pr√©-Processamento</strong></label>
        <p style="font-size:0.9rem; color:var(--text-muted)">Selecione as t√©cnicas de aumento/transforma√ß√£o.
        </p>
        <div id="tipo-checkboxes-preprocessing" style="display:flex; flex-wrap:wrap; gap:10px;">
            <label><input type="checkbox" value="T√©cnica 1"> T√©cnica 1</label>
            <label><input type="checkbox" value="T√©cnica 2"> T√©cnica 2</label>
            <label><input type="checkbox" value="T√©cnica 3"> T√©cnica 3</label>
        </div>
    </div>

    <div id="config-panel" class="card config-card mt-4">
        <div class="config-header" style="display:flex;justify-content:space-between;align-items:center">
            <strong>4. ‚öôÔ∏è Configura√ß√£o de Treino (YOLO)</strong>
            <div>
                <button id="reset-config-btn" class="btn btn-success" title="Restaurar padr√£o">Restaurar</button>
                <button id="edit-config-btn" class="btn" title="Editar configura√ß√£o">Editar</button>
            </div>
        </div>
        <pre id="config-preview" class="config-preview" aria-live="polite"
            style="margin-top:10px;white-space:pre-wrap;word-break:break-word"></pre>

        <div id="config-editor" class="config-editor hidden" style="margin-top:10px">
            <textarea id="config-json" class="config-textarea" rows="14"></textarea>
            <div style="margin-top:8px;display:flex;gap:8px;justify-content:flex-end">
                <button id="save-config-btn" class="btn btn-success">Salvar</button>
                <button id="cancel-config-btn" class="btn">Cancelar</button>
            </div>
            <div id="config-error" class="alert-error hidden" style="margin-top:8px"></div>
        </div>
    </div>

    <hr style="margin:20px 0;">

    <div style="margin-top:20px; display: flex; gap: 10px; align-items: center;">
        <button class="btn" id="start-training-btn">‚ñ∂Ô∏è Iniciar Treinamento</button>
        <button class="btn btn-danger hidden" id="cancel-training-btn" disabled>‚ùå Cancelar Treinamento</button>
    </div>

    <div class="progress-bar" style="margin-top:10px">
        <div id="progress-fill" class="progress-fill"></div>
    </div>

    <h3>Log de Treinamento</h3>
    <textarea id="logs" readonly
        style="margin-top:12px; background: #1e1e1e; color: #00ff00; height: 450px; overflow-y: scroll; padding: 10px; border-radius: 5px;"></textarea>

    <div class="chart-placeholder" style="margin-top:12px">Gr√°fico de Accuracy e Loss (simulado)</div>

</div>